<div class="container" id="patientID" *ngIf="patient">
  <div class="patient-container">

    <app-patient-nav class="nav patient-nav" [ngClass]="patient.cohort" [cohort]="patient.cohort"></app-patient-nav>

    <div class="patient-content">

      <!-- NAV: ID + cohort -->
      <div class="patient-header">
        <div class="page-header" [ngClass]="patient.cohort">
          <h1>Patient {{ patient.patientLabel }}</h1>
        </div>

        <div class="cohort-group">
          <span class="cohort" [ngClass]="patient.cohort">{{ patient.cohort }}</span>
          <span class="outcome" [ngClass]="[patient.outcome, patient.cohort]">{{ patient.outcome }}</span>
        </div>
      </div>

      <!-- IDS -->
      <div class="container patient-ids">
        <div class="altIDs">
          public ID: <span class="altID variable-value">{{ patientID }}</span>
        </div>

        <div class="altIDs" *ngIf="patient.alternateIdentifier">all IDs:<span class="altID variable-value" *ngFor="let id of patient.alternateIdentifier.sort()">{{ id }}</span>
        </div>
      </div>

      <!-- DEMOGRAPHICS -->
      <mat-expansion-panel class="panel-group" id="panel--demographics" [expanded]="demographicsPanelState" (opened)="demographicsPanelState = true" (closed)="demographicsPanelState = false">
        <mat-expansion-panel-header [collapsedHeight]="expansionPanelHeight" [expandedHeight]="expansionPanelHeight" class="panel-header">
          <mat-panel-title class="panel-title">
            <app-provenance-title class="flex-grow1" title="Demographics" [embargoed]="true"></app-provenance-title>
          </mat-panel-title>
        </mat-expansion-panel-header>

        <div class="container patient-metadata">
          <app-provenance [dateModified]="patient.dateModified" embargoLabel="Demographic" changes="initial data load" [embargoed]="true" class="provenance"></app-provenance>

          <div class="container patient-demographics">
            <app-patient-demographics [patient]="patient"></app-patient-demographics>
            <app-patient-relationships [patient]="patient"></app-patient-relationships>
            <app-patient-related [patient]="patient"></app-patient-related>
            <app-patient-dates [patient]="patient"></app-patient-dates>
          </div>

        </div>
      </mat-expansion-panel>

      <!-- SYMPTOMS  -->
      <ng-container *ngIf="patient.symptoms">
        <mat-expansion-panel class="panel-group" id="panel--symptoms" [expanded]="symptomsPanelState" (opened)="symptomsPanelState = true" (closed)="symptomsPanelState = false">
          <mat-expansion-panel-header [collapsedHeight]="expansionPanelHeight" [expandedHeight]="expansionPanelHeight">
            <mat-panel-title class="panel-title">
              <app-provenance-title class="flex-grow1" title="Symptoms" [embargoed]="true" [private]="true"></app-provenance-title>
            </mat-panel-title>
          </mat-expansion-panel-header>

          <app-provenance [dateModified]="patient.dateModified" class="provenance" [embargoed]="true"></app-provenance>
          <app-patient-symptoms [patient]="patient"></app-patient-symptoms>
        </mat-expansion-panel>
      </ng-container>

      <!-- SAMPLES  -->
      <mat-expansion-panel class="panel-group" id="panel--samples" [expanded]="samplesPanelState" (opened)="samplesPanelState = true" (closed)="samplesPanelState = false">
        <mat-expansion-panel-header [collapsedHeight]="expansionPanelHeight" [expandedHeight]="expansionPanelHeight">
          <mat-panel-title class="panel-title">
            <app-provenance-title class="flex-grow1" title="Samples"></app-provenance-title>
          </mat-panel-title>
        </mat-expansion-panel-header>

        <app-patient-samples [patient]="patient"></app-patient-samples>
      </mat-expansion-panel>


      <!-- CITATIONS -->
      <ng-container *ngIf="publications && publications.length > 0">
        <mat-expansion-panel class="panel-group" id="panel--citations" [expanded]="citationsPanelState" (opened)="citationsPanelState = true" (closed)="citationsPanelState = false">
          <mat-expansion-panel-header [collapsedHeight]="expansionPanelHeight" [expandedHeight]="expansionPanelHeight">
            <mat-panel-title class="panel-title">
              <app-provenance-title class="flex-grow1" title="Citations"></app-provenance-title>
            </mat-panel-title>
          </mat-expansion-panel-header>

          <div class="patient-citations">
            <h4 class="patient" id="citations">Cited in</h4>
            <app-patient-citations [publications]="publications"></app-patient-citations>
          </div>
        </mat-expansion-panel>
      </ng-container>


      <!-- DATA -->
      <div class="patient-data-header">
        <h3 class="data-title">Data</h3>

        <!-- icons of available experiments -->
        <!-- <div class="expt-type mat-shadow" [ngClass]="expt.identifier" *ngFor="let expt of exptTypes" [matTooltip]="expt.name" matTooltipPosition="above">
          <a [routerLink]="['../', patient.patientID]" [fragment]="expt.name | stripWhitespace">
            <svg-icon [icon]="expt.identifier" [ngClass]="expt.identifier + '-icon'"></svg-icon>
          </a>
        </div> -->
      </div>

      <div id="data" class="patient-data">

        <!-- ELISAS -->
        <mat-expansion-panel class="panel-group" id="ELISA" [expanded]="elisaPanelState" (opened)="elisaPanelState = true" (closed)="elisaPanelState = false">
          <mat-expansion-panel-header [collapsedHeight]="dataPanelHeight" [expandedHeight]="dataPanelHeight">
            <mat-panel-title class="panel-title">
              <app-provenance-title class="flex-grow1" title="ELISA Data" icon="elisa"></app-provenance-title>
            </mat-panel-title>
          </mat-expansion-panel-header>

          <app-provenance [dateModified]="patient.dateModified" class="provenance"></app-provenance>
          <app-patient-elisas [patient]="patient"></app-patient-elisas>
        </mat-expansion-panel>

        <!-- HLA -->
        <mat-expansion-panel class="panel-group" id="HLA-sequencing" [expanded]="hlaPanelState" (opened)="hlaPanelState = true" (closed)="hlaPanelState = false">
          <mat-expansion-panel-header [collapsedHeight]="dataPanelHeight" [expandedHeight]="dataPanelHeight">
            <mat-panel-title class="panel-title">
              <app-provenance-title class="flex-grow1" title="HLA Sequencing" icon="hla" [embargoed]="true"></app-provenance-title>
            </mat-panel-title>
          </mat-expansion-panel-header>
          <app-patient-hla [patient]="patient" [files]="HLAFiles"></app-patient-hla>
        </mat-expansion-panel>

        <!-- ViralSeq -->
        <mat-expansion-panel class="panel-group" id="viral-sequencing" [expanded]="viralSeqPanelState" (opened)="viralSeqPanelState = true" (closed)="viralSeqPanelState = false">
          <mat-expansion-panel-header [collapsedHeight]="dataPanelHeight" [expandedHeight]="dataPanelHeight">
            <mat-panel-title class="panel-title">
              <app-provenance-title class="flex-grow1" title="Viral Sequencing" icon="viralseq"></app-provenance-title>
            </mat-panel-title>
          </mat-expansion-panel-header>
          <app-patient-viral-seq [sequences]="viralSeq" [files]="viralFiles" [patientID]="patient.patientID"></app-patient-viral-seq>
        </mat-expansion-panel>

      </div>



      <!-- <div id="Systems-Serology">
          <app-patient-serology [patient]="patient"></app-patient-serology>
        </div> -->

    </div>
  </div>

</div>
